# MotionSaver Installation Guide
---

## Directory Structure

```
D:/MotionSaver
├── .cache.sqlite
├── a35_crop.jpg
├── a35_crop_crop.jpg
├── AMG.mp4
├── config/
├── Gui.bat
├── logs/
├── MotionSaver.bat
├── PhotoEngine.exe
├── _internal/
└── StopMotionSaver.bat
└── unhooks.exe

```

---

## Installation Steps

### 1. Download & Save to D Drive
- Download the latest MotionSaver release from the [Releases page](https://github.com/chinmay-sawant/MotionSaver/releases).
- Click [here to download MotionSaver v2](https://github.com/chinmay-sawant/MotionSaver/releases/download/V2/MotionSaver_V2.zip).
- Save the downloaded file directly to your `D:/` drive.
- ![Step 1: Downloaded File in D Drive](https://github.com/chinmay-sawant/MotionSaver/raw/master/Installation/step1.png)

### 2. Extract to D Drive
- Use an extraction tool like WinRAR or 7-Zip.
- Right-click the downloaded archive and select **Extract Here** to extract all files directly into the `D:/` drive.
- Ensure the folder structure matches the example below.
- ![Step 2: Extracted Files in D Drive](https://github.com/chinmay-sawant/MotionSaver/raw/master/Installation/step2.png)

### 3. Overview of the `D:/MotionSaver` Folder

The `D:/MotionSaver` folder contains all the files and subfolders required for MotionSaver to function. Here’s a quick overview of its contents:

- **.cache.sqlite**: Stores cached data for the application.
- **a35_crop.jpg, a35_crop_crop.jpg**: Sample images used by the screensaver.
- **AMG.mp4**: Sample video file for testing or demonstration.
- **config/**: Contains configuration files and user settings.
- **Gui.bat**: Batch file to launch the settings GUI.
- **logs/**: Stores log files generated by MotionSaver.
- **MotionSaver.bat**: Main batch file to start the screensaver service.
- **PhotoEngine.exe**: Executable for image processing tasks.
- **_internal/**: Internal files and dependencies required by the application.

Make sure your extracted folder matches this structure before proceeding.
- ![Step 3: Folder Structure in D Drive](https://github.com/chinmay-sawant/MotionSaver/raw/master/Installation/step3.png)


### 4. Start the Background Service
- ![Step 4: Background Service](https://github.com/chinmay-sawant/MotionSaver/raw/master/Installation/step4.png)

> Navigate to the `D:/MotionSaver` folder. (Do not run from download or any other folder as it may cause issues.)

- Right-click `MotionSaver.bat` and select **Run as administrator**.
- This starts the screensaver background service in the tray. 
- press **Win + S** to activate the screensaver.


> By default, the Mercedes AMG video (`AMG.mp4`) will be used as the lockscreen animation when the screensaver is activated.
> You can customize this later by replacing the `AMG.mp4` file or using the settings GUI.

### 5. Customize Settings Using Gui.bat 
- Right-click `Gui.bat` and select **Run as administrator** in the `D:/MotionSaver` folder to open the settings GUI.
- Use the interface to change the video, images, password, or other preferences for your screensaver.
- After making changes, click **Save** in the GUI to apply your settings.
- ![Step 5: Customizing with GUI](https://github.com/chinmay-sawant/MotionSaver/raw/master/Installation/step5.png)

---

## FAQs

**Q: The screensaver doesn't start when I press Win + S. What should I do?**
- Make sure the background service is running (see Step 4).
- You can check the system tray for the MotionSaver icon as displayed below.
- ![Step 4: Background Service](https://github.com/chinmay-sawant/MotionSaver/raw/master/Installation/system_tray.png)

**Q: How do I change the default password?**
- Open the settings GUI (see Step 5) and update the password field.
- default password is `test`. You should change it to something more secure.

**Q: What should I do if I get a black screen?**
1. Ensure that the extracted folder structure is correct and all files are present. You should launch the `MotionSaver.bat` from the `D:/MotionSaver` folder.
2. Press **Esc** to exit the screensaver.
3. Type `test` (the default password) to unlock.
4. If `test` does not work:
    - Press **Ctrl + Alt + Del** to bring up the Windows security screen.
    - The lockscreen should trigger—enter your Windows lockscreen password.
    - After unlocking, you can use **Alt + Tab** to switch windows.

**Q: I want to change the video. What are the steps?**
- You can either:
    - Download a sample 1080p 30fps video from the [Demo Videos folder](https://github.com/chinmay-sawant/MotionSaver/tree/master/Demo_Videos).
        - Avoid using 4K or 60fps videos, as these may cause lag on some systems.
        - Alternatively, download any 1080p 30fps video from YouTube or use a personal video, and save it to any directory (e.g., Downloads).
    - After downloading your preferred video, open `Gui.bat` as described in Step 5.
- In the GUI, use the option for changing the video file (see image below).
- Select your new video file and click **Save** to apply the changes.
> **Note:** After changing the video, make sure to restart the MotionSaver application. You can do this by clicking **Exit** in the system tray icon or by closing `PhotoEngine.exe` and `MotionSaver.bat` using Task Manager. Then, relaunch `MotionSaver.bat` to apply the changes.
- ![Change Video in GUI](https://github.com/chinmay-sawant/MotionSaver/raw/master/Installation/change_video.png)

**Q: My FPS feels glitchy, like it's running below 30 FPS. What should I do?**
1. Try changing the video using the GUI as shown above in the "I want to change the video" section.
2. Download another short 1080p video (about 10 seconds) from YouTube or any online source and test if the issue persists.
3. If you still experience problems, please upload your log files under a new issue on [GitHub Issues](https://github.com/chinmay-sawant/MotionSaver/issues), including your Instagram handle (if applicable) and your Windows version. This will help the developers diagnose the problem more effectively.

**Q: My antivirus thinks MotionSaver is a virus. What should I do?**
- MotionSaver is safe to use, but some antivirus programs may flag it because it includes batch files and executables.
- To resolve this, add the `D:/MotionSaver` folder to your antivirus exclusion list or temporarily disable your antivirus during installation.
- Refer to your antivirus software's documentation for steps to add a folder to the exclusion list.

**Q: Some Windows shortcuts (like Alt+Tab or Win+D) are not working while MotionSaver is running. Why?**
- MotionSaver is designed to behave like the default Windows lockscreen and uses low-level keyboard hooks to secure the lockscreen experience.
- As a result, certain Windows shortcuts may be blocked while the screensaver is active.
- If you need to restore shortcut functionality, pressing **Ctrl + Alt + Del** will release the hooks and allow special shortcuts to work again.
- If **Ctrl + Alt + Del** does not work, run `StopMotionSaver.bat` as administrator inside `D:/MotionSaver`. This script will attempt to release any stuck keyboard hooks and restore shortcut functionality.  
- The `StopMotionSaver.bat` script was added in [#14 feature/quickfix](https://github.com/chinmay-sawant/MotionSaver/pull/14).
- This is a known limitation and will be addressed in future updates.

**Q: How do I send logs to the developers?**
- If you have installed MotionSaver in `D:/MotionSaver`, you will find a `logs` folder inside it.
- It is recommended to open an issue ticket on the [GitHub Issues page](https://github.com/chinmay-sawant/MotionSaver/issues).
- Please mention details like your Windows version and a description of the problem.
- Attach the relevant log files from the `logs` folder to your issue by dragging and dropping them or using the attachment option on GitHub.
- This helps the developers diagnose and resolve your issue more efficiently.

**Q: Where do I report bugs or get help?**
- Please open an issue on the [GitHub Issues page](https://github.com/chinmay-sawant/MotionSaver/issues).


---
